#
# Copyright 2016 6WIND S.A.

- id: 6wind-virtual-accelerator
  type: group
  role: [6wind-virtual-accelerator]
  requires: [6wind-virtual-accelerator-start]
  required_for: [deploy_end]
  parameters:
   strategy:
     type: one_by_one

- id: 6wind-virtual-accelerator-update-packages
  type: puppet
  role: [6wind-virtual-accelerator]
  required_for: [pre_deployment_end]
  requires: [pre_deployment_start]
  parameters:
    puppet_manifest: puppet/manifests/external_repo.pp
    puppet_modules: puppet/modules:/etc/puppet/modules
    timeout: 3600

- id: 6wind-virtual-accelerator-install
  type: puppet
  role: [6wind-virtual-accelerator]
  required_for: [6wind-virtual-accelerator-configure]
  requires: [compute]
  parameters:
    puppet_manifest: puppet/manifests/install_va.pp
    puppet_modules: puppet/modules:/etc/puppet/modules
    timeout: 3600

- id: 6wind-virtual-accelerator-configure
  type: puppet
  role: [6wind-virtual-accelerator]
  required_for: [6wind-virtual-accelerator-start]
  requires: [6wind-virtual-accelerator-install]
  parameters:
    puppet_manifest: puppet/manifests/configure_va.pp
    puppet_modules: puppet/modules:/etc/puppet/modules
    timeout: 240

- id: 6wind-virtual-accelerator-start
  type: puppet
  role: [6wind-virtual-accelerator]
  required_for: [6wind-virtual-accelerator]
  requires: [6wind-virtual-accelerator-configure]
  parameters:
    puppet_manifest: puppet/manifests/start_va.pp
    puppet_modules: puppet/modules:/etc/puppet/modules
    timeout: 3600
